---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/sections/Footer.astro';
import Header from '../components/sections/Header.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../consts';
import HeroSection from '../components/sections/HeroSection.astro';
import ServiceCards from '../components/sections/ServiceCards.astro';
import NewsGrid from '../components/sections/NewsGrid.astro';
import SkillsSection from '../components/sections/SkillsSection.astro';
import ProcessSection from '../components/sections/ProcessSection.astro';
import SEOServicesGrid from '../components/sections/SEOServicesGrid.astro';
import SEOServicesGridV2 from '../components/sections/SEOServicesGridV2.astro';
import { skills } from '../data/skills';
import { getCollection } from 'astro:content';

// Get latest blog posts
const posts = (await getCollection('blog'))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
const latestPost = posts[0];
const recentPosts = posts.slice(0, 3);

// Transform skills to services format
const services = skills.slice(0, 6).map(skill => ({
  ...skill,
  href: '/about#skills'
}));
---

<!doctype html>
<html lang="en" data-theme="dark" class="dark">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
    <!-- JSON-LD: Organization -->
    <script type="application/ld+json" set:html={JSON.stringify({
      '@context': 'https://schema.org',
      '@type': 'Organization',
      name: 'Austin Crockett',
      url: new URL('/', Astro.site).toString(),
      logo: new URL('/favicon.svg', Astro.site).toString(),
      sameAs: [
        'https://linkedin.com/in/austincrockett',
        'https://github.com/misterflacko'
      ],
    })} />
	</head>
	<body>
		<Header />
		<main class="full-width">
      <!-- Hero Section -->
      <HeroSection
        title="SEO for the"
        titleHighlight="AI-Powered Search Era"
        subtitle="Traditional SEO meets Generative Engine Optimization (GEO). I help brands stay visible across Google, ChatGPT, Perplexity, and every AI-powered search surface."
        showCTA
        primaryCTA={{ text: 'View Portfolio', href: '/portfolio' }}
        secondaryCTA={{ text: 'Read Blog', href: '/blog' }}
        featuredBanner={latestPost ? {
          label: 'Latest Post',
          title: latestPost.data.title,
          href: `/blog/${latestPost.slug}`
        } : undefined}
      />

      <!-- Services Section -->
      <section class="content-section">
        <div class="content-container">
          <ServiceCards
            title="Future-Proof Your Search Visibility"
            subtitle="From traditional SEO to AI-powered discovery, comprehensive strategies for the evolving search landscape."
            services={services}
          />
        </div>
      </section>

      <!-- SEO/GEO Services Grid V2 - Graphite Inspired -->
      <SEOServicesGridV2
        title="Search Optimization in the AI Era"
        subtitle="From traditional SEO to Generative Engine Optimization (GEO), I help brands stay visible across every search surface—whether it's Google, ChatGPT, Perplexity, or the next AI breakthrough."
      />

      <!-- Latest Insights / Blog Section -->
      {recentPosts.length > 0 && (
        <section class="content-section">
          <div class="content-container">
            <NewsGrid
              title="Latest Insights"
              subtitle="SEO, GEO, and the evolving search landscape—strategies for staying visible in the AI era."
              posts={recentPosts}
            />
          </div>
        </section>
      )}

      <!-- Skills & Tools Section -->
      <section class="content-section content-section--alt">
        <div class="content-container">
          <SkillsSection title="Skills & Tools" skills={skills} />
        </div>
      </section>

      <!-- Process Section -->
      <section class="content-section">
        <div class="content-container">
          <ProcessSection
            title="How I Work"
            subtitle="A proven approach combining traditional SEO expertise with modern AI-powered search strategies."
          />
        </div>
      </section>

		</main>
		<Footer />
	</body>
</html>

<style>
  .content-section {
    padding: clamp(2.5rem, 5vw, 4rem) 1.5rem;
  }

  .content-section--alt {
    background: hsl(var(--muted) / 0.3);
  }

  .content-container {
    max-width: 1200px;
    margin: 0 auto;
  }

  @media (min-width: 768px) {
    .content-section {
      padding: clamp(3rem, 6vw, 5rem) 2rem;
    }
  }

  @media (min-width: 1024px) {
    .content-section {
      padding: clamp(3.5rem, 7vw, 6rem) 2.5rem;
    }
  }
</style>
